name: PageVault Worker Tick

on:
  schedule:
    - cron: "*/5 * * * *"
  workflow_dispatch:

concurrency:
  group: pagevault-worker
  cancel-in-progress: false

jobs:
  tick-worker:
    runs-on: ubuntu-latest
    timeout-minutes: 5
    steps:
      - name: Trigger PageVault worker
        run: |
          curl --fail --show-error --silent \
            -X POST "${{ secrets.PAGEVAULT_APP_URL }}/api/worker/run?limit=1&enqueue=1" \
            -H "x-cron-secret: ${{ secrets.CRON_SECRET }}" \
            -H "content-type: application/json"
